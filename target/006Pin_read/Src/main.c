/**
  ******************************************************************************
  * @file    main.c
  * @author  Auto-generated by STM32CubeIDE
  * @version V1.0
  * @brief   Default main function.
  ******************************************************************************
*/

#include<stdint.h>

int main(void)
{
	/* All peripheral registers are of 32 bits. So, that's why,
	 * we selected unit32_t and also addresses are always unsigned.*/

	/* We can't express pointer variable like
	 * uint32_t* pClkctrlreg = 0x40023830, because 0x40023830 is a number
	 * for the compiler. So we have to tell the compiler that this is a
	 * pointer. That's why we have to use type casting:
	 * (unit32_t*) 0x40023830 - now this is a pointer entity*/

	uint32_t volatile *const pClkctrlReg = (uint32_t*) 0x40023830;//pClkctrlreg - clock register
	uint32_t volatile *const pPortDModeReg = (uint32_t*) 0x40020C00;// this address for GPIOD mode register
	uint32_t volatile *const pPortDOutReg = (uint32_t*) 0x40020C14;

	uint32_t volatile *const pPortAModeReg = (uint32_t*) 0x40020000;// this address for GPIOA mode register


	/* this is port A input data register, and for the input data register programmer should not
	 * write anything. So, that's why, we can even make this as const volatile */
	uint32_t const volatile *const pPortaInReg = (uint32_t*)0x40020010;

	//Enable the clock for DPOID and GPIOA peripherals in the AHB1ENR

	 *pClkctrlReg |= (1 << 3);//this is for GPIOD
	 *pClkctrlReg |= (1 << 0);//this is for GPIOA

	//Configuring PD12 as output

	// a. clear the 24th and 25th bit positions (CLEAR).
	 *pPortDModeReg &= ~(3 << 24);

	 //b. make 24th bit position as 1 (SET)
	*pPortDModeReg |= (1 << 24);

	 //Configuring PA0 as input mode (GPIOA MODE REGISTER)
	 *pPortAModeReg &= ~(3 << 0);






	while(1){

		 //read the pin status of the pin PA0 (GPIOA INPUT DATA REGISTER)
		 /* If we will write like this
		  *  uint8_t pinStatus = *pPortaInReg;
		  *  we will get 32 bits of data.
		  *  But we need just one bit the status of bit position 0.
		  *  So, we can do a masking in order to 0 out all other bits except the bit position 0.*/

		uint8_t pinStatus = (uint8_t) (*pPortaInReg & 0x1);

		if(pinStatus){
			 //turn on the LED
			 *pPortDOutReg |= (1 << 12);
		 } else{
			 //turn off the LED
			 *pPortDOutReg &= ~(1 << 12);
		 }
	}

}








